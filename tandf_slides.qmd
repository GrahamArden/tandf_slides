---
title: "Proknow: Can we automate the process?"
subtitle: "..and why is it not as easy as you think"
format: clean-revealjs
html-math-method:
  method: mathjax
  url: "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"
author:
  - name: "Graham Arden"
    orcid: 0000-0000-0000-0000
    email: graham.arden@nhs.net
    affiliations: Radiation Physics Department, The Queen's Centre, Castle Hill Hospital
date: last-modified
title-slide-attributes:
  data-background-image: ./images/NHS_Humber.png
  data-background-size: contain
  data-background-opacity: "0.8"
incremental: true
---

### What is our goal?
- For scorecards to work we need to allocate patients to the correct collection
- The volumes need to use the names defined in the scorecards
---

### Can we automate allocation to collections?

- It depends
- You need quite a lot of imformation to decide which collection (if any) a plan belongs to
  
---

### What information do we need?

  - Dose
  - Fractionation
  - PTV volume (for SABR collections)
  - Laterality (for breast collections)
  - Patient age at time of treatment (for breast IMN collections)

---

### Unfortunately, it's not that simple
::: {.nonincremental}
- Not all the data we require _is in Proknow_


---


### Laterality

- For laterality we _could_ apply a regular expression to the plan name:

```{.python}

allocate_plan_id_lookups = [(re.compile(r"l(?:t|eft)?\s*(Lung)", re.IGNORECASE), national_collection_name_lung, "LEFT"),
                            (re.compile(r"r(?:t|ight)?\s*(Lung)", re.IGNORECASE), national_collection_name_lung, "RIGHT"),
                            (re.compile(r"l(?:t|eft)?\s*((?:(b)(r)?(east?)?)|cw|chestwall)", re.IGNORECASE), national_collection_name_breast, "LEFT"),
                            (re.compile(r"r(?:t|ight)?\s*((?:(b)(r)?(east?)?)|cw|chestwall)", re.IGNORECASE), national_collection_name_breast, "RIGHT")]
```

- This found _most_ of the relevant plans.

:::

---

### But this data _may be_ in ARIA (or Mosaic)

- We just need to extract it and match it with the Proknow data

### Prescription data
::: {.nonincremental}
![](./images/NHS21_prescription.PNG)
:::

  